<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Void | Immersive Meditation</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>

<body>

    <!-- Visual Background -->
    <div id="visual-container"></div>
    <iframe id="external-shader-frame"
        style="display: none; border: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1;"></iframe>

    <!-- Breathing Guide Overlay -->
    <div id="breath-guide">
        <span class="breath-text text-inhale">Inhale</span>
        <span class="breath-text text-hold">Hold</span>
        <span class="breath-text text-exhale">Exhale</span>
    </div>

    <!-- UI Layer -->
    <div class="ui-layer">

        <!-- Screen 1: Gateway -->
        <div id="screen-gateway" class="screen active">
            <h1>The Void</h1>
            <div class="subtitle">Enter the State of Flow</div>

            <div class="card-container">
                <div class="card" id="btn-guided">
                    <h3>Guided Journey</h3>
                    <p>Curated ambient soundscapes for relaxation.</p>
                </div>
                <div class="card" id="btn-focus">
                    <h3>Deep Focus</h3>
                    <p>Customizable binaural beats for concentration.</p>
                </div>
            </div>

            <div class="toggle-container">
                <span>Breathing Mode (4-7-8)</span>
                <label class="switch">
                    <input type="checkbox" id="breath-toggle">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <!-- Screen 2: Selection -->
        <div id="screen-selection" class="screen">
            <button id="btn-back-selection" class="back-arrow" title="Back">
                <svg viewBox="0 0 24 24">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" />
                </svg>
            </button>

            <!-- Guided Mode Content (Placeholder for now) -->
            <div id="selection-guided" style="display: none;">
                <h2>Select Journey</h2>
                <div class="card-container">
                    <div class="card">
                        <h3>Rainy Tokyo</h3>
                    </div>
                    <div class="card">
                        <h3>Tibetan Bowl</h3>
                    </div>
                    <div class="card">
                        <h3>Space Travel</h3>
                    </div>
                </div>
            </div>

            <!-- Focus Mode Content -->
            <div id="selection-focus" class="control-panel">
                <h2>Configure Focus</h2>

                <div class="slider-group">
                    <div class="slider-label">
                        <span>Binaural Frequency</span>
                        <span id="hz-display">10 Hz</span>
                    </div>
                    <input type="range" id="focus-hz" min="1" max="40" value="10" step="0.5">
                    <div style="font-size: 0.7rem; color: #666; margin-top: 5px;">
                        1-4Hz (Sleep) • 4-8Hz (Deep) • 8-14Hz (Relax) • 14-30Hz (Focus)
                    </div>
                </div>

                <div style="margin-top: 20px;">
                    <div class="slider-label" style="margin-bottom: 10px;">Visual Theme</div>
                    <div class="selection-grid" style="margin-bottom: 0;">
                        <div class="shader-preview selected" data-shader="neonRings" data-label="Neon Rings"></div>
                        <div class="shader-preview" data-shader="starTunnel" data-label="Star Tunnel"></div>
                        <div class="shader-preview" data-shader="oceanWaves" data-label="Ocean Waves"></div>
                        <div class="shader-preview" data-shader="chromeDream" data-label="Chrome Dreams"></div>
                        <div class="shader-preview" data-shader="hyperdrive" data-label="Hyperdrive"></div>
                        <div class="shader-preview" data-shader="starNest" data-label="Star Nest"></div>
                        <div class="shader-preview" data-shader="starTunnel3D" data-label="Star Tunnel 3D"></div>
                        <div class="shader-preview" data-shader="sunset" data-label="Sunset"></div>
                        <div class="shader-preview" data-shader="vortex" data-label="Vortex"></div>
                        <div class="shader-preview" data-shader="octahedron" data-label="Octahedron"></div>
                        <div class="shader-preview" data-shader="sacredGeometry" data-label="Sacred Geometry"></div>
                        <div class="shader-preview" data-shader="rainForest" data-label="Rain Forest"></div>
                    </div>
                </div>

                <!-- Dynamic Shader Controls -->
                <div id="shader-controls" class="shader-controls-container">
                    <!-- Controls will be generated here -->
                </div>

                <button id="btn-enter-void" class="btn-main">Enter Void</button>
            </div>
        </div>

        <!-- Screen 3: Immersion (Hidden UI) -->
        <div id="screen-immersion" class="screen">
            <div id="immersion-controls">
                <button id="btn-exit" class="corner-btn top-right" title="Exit">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
                    </svg>
                </button>

                <button id="btn-fullscreen" class="corner-btn bottom-right" title="Fullscreen">
                    <svg viewBox="0 0 24 24">
                        <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z" />
                    </svg>
                </button>
            </div>
        </div>

    </div>

    <!-- Main Application Script -->
    <script type="module" src="js/app.js"></script>
</body>

</html>