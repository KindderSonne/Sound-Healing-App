<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Void | Immersive Meditation</title>
    <link rel="stylesheet" href="css/style.css">
    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>

<body>

    <!-- Visual Background -->
    <div id="visual-container"></div>
    <iframe id="external-shader-frame"
        style="display: none; border: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1;"></iframe>

    <!-- YouTube Player Container (for Guided Mode) -->
    <div id="youtube-container" style="display: none;">
        <div id="youtube-player"></div>
        <!-- Overlay to block YouTube controls interaction -->
        <div id="youtube-overlay"></div>
    </div>

    <!-- Breathing Guide Overlay -->
    <div id="breath-guide">
        <span class="breath-text text-inhale">Inhale</span>
        <span class="breath-text text-hold">Hold</span>
        <span class="breath-text text-exhale">Exhale</span>
    </div>

    <!-- UI Layer -->
    <div class="ui-layer">

        <!-- Screen 1: Gateway -->
        <div id="screen-gateway" class="screen active">
            <h1>The Void</h1>
            <div class="subtitle">Enter the State of Flow</div>

            <div class="card-container">
                <div class="card" id="btn-guided">
                    <h3>Guided Journey</h3>
                    <p>Curated ambient soundscapes for relaxation.</p>
                </div>
                <div class="card" id="btn-focus">
                    <h3>Deep Focus</h3>
                    <p>Customizable binaural beats for concentration.</p>
                </div>
            </div>

            <div class="toggle-container">
                <span>Breathing Mode (4-7-8)</span>
                <label class="switch">
                    <input type="checkbox" id="breath-toggle">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <!-- Screen 2: Selection -->
        <div id="screen-selection" class="screen">
            <button id="btn-back-selection" class="back-arrow" title="Back">
                <svg viewBox="0 0 24 24">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" />
                </svg>
            </button>

            <!-- Guided Mode Content -->
            <div id="selection-guided" class="control-panel" style="display: none;">
                <div class="panel-title">Select Journey</div>
                <p style="color: #888; font-size: 0.85rem; margin-bottom: 20px;">
                    Curated ambient soundscapes for deep relaxation
                </p>
                <div id="guided-videos" class="guided-grid">
                    <!-- Videos will be populated dynamically -->
                </div>
            </div>

            <!-- Focus Mode Content -->
            <div id="selection-focus" class="control-panel">
                <div class="panel-title">Configure Focus</div>

                <!-- Binaural Setup Section -->
                <div class="slider-label" style="margin-bottom: 15px; font-size: 0.9rem; font-weight: 600;">Binaural
                    Setup</div>

                <!-- Presets -->
                <div class="presets-grid" style="margin-bottom: 20px;">
                    <button class="preset-btn" data-base="100" data-beat="2">
                        <span>Delta</span>
                        <span class="preset-freq">2 Hz</span>
                    </button>
                    <button class="preset-btn" data-base="150" data-beat="6">
                        <span>Theta</span>
                        <span class="preset-freq">6 Hz</span>
                    </button>
                    <button class="preset-btn" data-base="200" data-beat="10">
                        <span>Alpha</span>
                        <span class="preset-freq">10 Hz</span>
                    </button>
                    <button class="preset-btn" data-base="250" data-beat="20">
                        <span>Beta</span>
                        <span class="preset-freq">20 Hz</span>
                    </button>
                    <button class="preset-btn" data-base="300" data-beat="40">
                        <span>Gamma</span>
                        <span class="preset-freq">40 Hz</span>
                    </button>
                    <button class="preset-btn" data-base="200" data-beat="7.83">
                        <span>Earth</span>
                        <span class="preset-freq">7.83 Hz</span>
                    </button>
                </div>

                <!-- Divider -->
                <hr class="section-divider" style="margin: 15px 0;">

                <!-- Base Frequency -->
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Base Frequency</span>
                        <span id="base-hz-display">200 Hz</span>
                    </div>
                    <input type="range" id="base-hz" min="50" max="500" value="200" step="10">
                </div>

                <!-- Beat Frequency -->
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Beat Frequency</span>
                        <span id="hz-display">10 Hz</span>
                    </div>
                    <input type="range" id="focus-hz" min="1" max="40" value="10" step="0.5">
                    <div style="font-size: 0.7rem; color: #666; margin-top: 5px;">
                        1-4Hz (Sleep) • 4-8Hz (Deep) • 8-14Hz (Relax) • 14-30Hz (Focus)
                    </div>
                </div>

                <!-- Duration -->
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Duration</span>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <button id="infinite-toggle" class="toggle-btn active">Infinite</button>
                            <span id="duration-display">∞</span>
                        </div>
                    </div>
                    <input type="range" id="duration" min="30" max="300" value="60" step="30" disabled
                        style="opacity: 0.3;">
                    <div id="duration-hint" style="font-size: 0.7rem; color: #666; margin-top: 5px; opacity: 0.3;">
                        30s • 1min • 2min • 3min • 4min • 5min
                    </div>
                </div>

                <!-- Volume -->
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Volume</span>
                        <span id="volume-display">50%</span>
                    </div>
                    <input type="range" id="volume" min="0" max="100" value="50" step="5">
                </div>

                <!-- Preview Button -->
                <div class="preview-container" style="display: flex; align-items: center; gap: 15px; margin-top: 10px;">
                    <button id="btn-preview" class="btn-preview">
                        <svg id="preview-icon-play" viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                            <path d="M8 5v14l11-7z" />
                        </svg>
                        <svg id="preview-icon-stop" viewBox="0 0 24 24" width="20" height="20" fill="currentColor"
                            style="display: none;">
                            <path d="M6 6h12v12H6z" />
                        </svg>
                        <span id="preview-text">Preview</span>
                    </button>
                    <span id="preview-status" style="font-size: 0.75rem; color: #666;"></span>
                </div>

                <!-- Divider -->
                <hr class="section-divider">

                <div style="margin-top: 20px;">
                    <div class="slider-label" style="margin-bottom: 10px; font-weight: 600;">Visual Theme</div>
                    <div class="shaders-grid">
                        <button class="shader-btn" data-shader="neonRings">Neon Rings</button>
                        <button class="shader-btn" data-shader="starTunnel">Star Tunnel</button>
                        <button class="shader-btn" data-shader="oceanWaves">Ocean Waves</button>
                        <button class="shader-btn" data-shader="chromeDream">Chrome Dreams</button>
                        <button class="shader-btn" data-shader="hyperdrive">Hyperdrive</button>
                        <button class="shader-btn" data-shader="starNest">Star Nest</button>
                        <button class="shader-btn" data-shader="starTunnel3D">Star Tunnel 3D</button>
                        <button class="shader-btn active" data-shader="sunset">Sunset</button>
                        <button class="shader-btn" data-shader="vortex">Vortex</button>
                        <button class="shader-btn" data-shader="octahedron">Octahedron</button>
                        <button class="shader-btn" data-shader="sacredGeometry">Sacred Geometry</button>
                        <button class="shader-btn" data-shader="rainForest">Rain Forest</button>
                    </div>
                </div>

                <!-- Dynamic Shader Controls -->
                <div id="shader-controls" class="shader-controls-container">
                    <!-- Controls will be generated here -->
                </div>

                <button id="btn-enter-void" class="btn-main">Enter Void</button>
            </div>
        </div>

        <!-- Screen 3: Immersion (Hidden UI) -->
        <div id="screen-immersion" class="screen">
            <div id="immersion-controls">
                <button id="btn-exit" class="corner-btn top-right" title="Exit">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
                    </svg>
                </button>

                <button id="btn-fullscreen" class="corner-btn bottom-right" title="Fullscreen">
                    <svg viewBox="0 0 24 24">
                        <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z" />
                    </svg>
                </button>
            </div>
        </div>

    </div>

    <!-- Main Application Script -->
    <script type="module" src="js/app.js"></script>
</body>

</html>